@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ─── Light Theme: Crystal ─── */
    --background: 220 30% 97%;
    --foreground: 220 40% 8%;
    --card: 0 0% 100%;
    --card-foreground: 220 40% 8%;
    --popover: 0 0% 100%;
    --popover-foreground: 220 40% 8%;
    --primary: 263 70% 52%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 20% 94%;
    --secondary-foreground: 220 40% 8%;
    --muted: 220 20% 93%;
    --muted-foreground: 220 15% 46%;
    --accent: 199 90% 45%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --warning: 38 92% 50%;
    --success: 142 72% 40%;
    --border: 220 20% 82%;
    --input: 220 20% 90%;
    --ring: 263 70% 52%;
    --radius: 1rem;
    --chart-1: 263 70% 52%;
    --chart-2: 199 90% 45%;
    --chart-3: 142 72% 40%;
    --chart-4: 38 92% 50%;
    --chart-5: 0 84% 60%;
    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 220 40% 8%;
    --sidebar-primary: 263 70% 52%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 20% 94%;
    --sidebar-accent-foreground: 220 40% 8%;
    --sidebar-border: 220 20% 82%;
    --sidebar-ring: 263 70% 52%;

    /* Glass system */
    --glass-r: 255;
    --glass-g: 255;
    --glass-b: 255;
    --glass-opacity: 0.72;
    --glass-border-opacity: 0.85;
    --glass-blur: 20px;
    --glow-primary-r: 109; --glow-primary-g: 40;  --glow-primary-b: 217;
    --glow-accent-r:  2;   --glow-accent-g:  132; --glow-accent-b:  199;
    --orb-opacity: 0.13;

    /* Header — light: near-white frosted */
    --header-bg-r: 245; --header-bg-g: 246; --header-bg-b: 250;
    --header-bg-opacity: 0.5;
    --header-border-opacity: 0.3;
  }

  .dark {
    /* ─── Dark Theme: Nebula ─── */
    --background: 222 47% 5%;
    --foreground: 210 40% 97%;
    --card: 220 40% 8%;
    --card-foreground: 210 40% 97%;
    --popover: 222 47% 6%;
    --popover-foreground: 210 40% 97%;
    --primary: 262 83% 68%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 30% 12%;
    --secondary-foreground: 210 40% 97%;
    --muted: 220 30% 12%;
    --muted-foreground: 220 20% 55%;
    --accent: 191 97% 55%;
    --accent-foreground: 220 40% 5%;
    --destructive: 0 72% 55%;
    --destructive-foreground: 0 0% 98%;
    --warning: 38 92% 52%;
    --success: 142 72% 45%;
    --border: 262 50% 60% / 0.18;
    --input: 220 30% 14%;
    --ring: 262 83% 68%;
    --chart-1: 262 83% 68%;
    --chart-2: 191 97% 55%;
    --chart-3: 142 72% 45%;
    --chart-4: 38 92% 52%;
    --chart-5: 0 72% 55%;
    --sidebar-background: 222 47% 6%;
    --sidebar-foreground: 210 40% 97%;
    --sidebar-primary: 262 83% 68%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 30% 12%;
    --sidebar-accent-foreground: 210 40% 97%;
    --sidebar-border: 262 50% 60% / 0.15;
    --sidebar-ring: 262 83% 68%;

    /* Glass system */
    --glass-r: 168;
    --glass-g: 85;
    --glass-b: 247;
    --glass-opacity: 0.05;
    --glass-border-opacity: 0.1;
    --glass-blur: 24px;
    --glow-primary-r: 168; --glow-primary-g: 85;  --glow-primary-b: 247;
    --glow-accent-r:  6;   --glow-accent-g:  214; --glow-accent-b:  245;
    --orb-opacity: 0.18;

    /* Header — dark: deep navy, slightly translucent for blur to show */
    --header-bg-r: 8; --header-bg-g: 10; --header-bg-b: 24;
    --header-bg-opacity: 0.5;
    --header-border-opacity: 0.1;
  }
}

/* ───────────────────────────────────────────────
   BASE STYLES
─────────────────────────────────────────────── */
@layer base {
  * {
    @apply border-border;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-background text-foreground;
    min-height: 100vh;
    background-image:
      radial-gradient(ellipse 70% 60% at 15% 15%, hsl(var(--primary) / 0.16) 0%, transparent 60%),
      radial-gradient(ellipse 55% 50% at 85% 8%,  hsl(var(--accent) / 0.13)  0%, transparent 55%),
      radial-gradient(ellipse 60% 55% at 65% 88%, hsl(var(--primary) / 0.1)  0%, transparent 55%),
      radial-gradient(ellipse 50% 45% at 5%  75%, hsl(var(--accent) / 0.1)   0%, transparent 50%),
      radial-gradient(ellipse 45% 40% at 90% 90%, hsl(var(--primary) / 0.08) 0%, transparent 45%),
      radial-gradient(ellipse 65% 60% at 45% 50%, hsl(var(--accent) / 0.05)  0%, transparent 55%);
    background-attachment: fixed;
  }

  /* Recharts theme overrides */
  .recharts-pie-label-text { fill: hsl(var(--foreground)) !important; }
  .recharts-legend-item { color: hsl(var(--foreground)) !important; }
  .recharts-cartesian-grid line { stroke: hsl(var(--border)) !important; opacity: 0.4; }

  /* Focus ring */
  :focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }
}

/* ───────────────────────────────────────────────
   GLASSMORPHISM SYSTEM
─────────────────────────────────────────────── */
@layer components {

  /* ── Core Glass Surface ── */
  .glass {
    background: rgba(var(--glass-r), var(--glass-g), var(--glass-b), var(--glass-opacity));
    backdrop-filter: blur(var(--glass-blur)) saturate(180%);
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(180%);
    border: 1px solid rgba(255, 255, 255, var(--glass-border-opacity));
  }

  /* ── Glass Card (shimmer on hover) ── */
  .glass-card {
    @apply glass;
    position: relative;
    overflow: hidden;
    border-radius: calc(var(--radius) * 1.25);
    box-shadow:
      0 4px 24px -4px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.08),
      0 1px 4px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .glass-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -120%;
    width: 60%;
    height: 100%;
    background: linear-gradient(
      105deg,
      transparent 0%,
      rgba(255, 255, 255, 0.08) 50%,
      transparent 100%
    );
    transition: left 0.7s ease;
    pointer-events: none;
    z-index: 1;
  }

  .glass-card:hover::before {
    left: 160%;
  }

  .glass-card:hover {
    transform: translateY(-3px);
    box-shadow:
      0 0 0 1px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.25),
      0 20px 60px -8px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.2),
      0 8px 24px rgba(0, 0, 0, 0.12),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  /* ── Sidebar Glass ── */
  .glass-sidebar {
    background: rgba(var(--glass-r), var(--glass-g), var(--glass-b), calc(var(--glass-opacity) * 1.2));
    backdrop-filter: blur(28px) saturate(200%);
    -webkit-backdrop-filter: blur(28px) saturate(200%);
    border-right: 1px solid rgba(255, 255, 255, var(--glass-border-opacity));
    border-left: none;
    border-top: none;
    border-bottom: none;
    box-shadow: 4px 0 24px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.06);
  }

  /* ── Header Glass ── */
  .glass-header {
    background: rgba(var(--header-bg-r), var(--header-bg-g), var(--header-bg-b), var(--header-bg-opacity));
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    border-bottom: 1px solid rgba(255, 255, 255, var(--header-border-opacity));
    border-top: none;
    border-left: none;
    border-right: none;
    box-shadow: 0 1px 0 rgba(255, 255, 255, calc(var(--header-border-opacity) * 0.5)),
                0 4px 24px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.08);
  }

  /* ── Glowing Active Nav ── */
  .nav-glow-active {
    background: linear-gradient(
      135deg,
      rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.28),
      rgba(var(--glow-accent-r), var(--glow-accent-g), var(--glow-accent-b), 0.16)
    ) !important;
    box-shadow:
      0 0 0 1px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.45),
      0 0 20px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  /* ── Gradient Text ── */
  .gradient-text {
    background: linear-gradient(135deg,
      hsl(var(--primary)) 0%,
      hsl(var(--accent)) 100%
    );
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* ── Gradient Button ── */
  .btn-gradient {
    background: linear-gradient(135deg,
      hsl(var(--primary)) 0%,
      hsl(var(--accent)) 100%
    );
    box-shadow:
      0 4px 15px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.35),
      0 1px 4px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.25);
    transition: box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .btn-gradient:hover {
    box-shadow:
      0 8px 28px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.5),
      0 2px 8px rgba(0, 0, 0, 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
  }

  .btn-gradient:active {
    transform: translateY(0);
  }

  /* ── Neon Status Badges ── */
  .badge-valid {
    background: rgba(34, 197, 94, 0.13);
    border: 1px solid rgba(34, 197, 94, 0.35);
    color: #22c55e;
    box-shadow: 0 0 12px rgba(34, 197, 94, 0.18), inset 0 1px 0 rgba(255,255,255,0.12);
  }

  .badge-expiring {
    background: rgba(234, 179, 8, 0.13);
    border: 1px solid rgba(234, 179, 8, 0.35);
    color: #d97706;
    box-shadow: 0 0 12px rgba(234, 179, 8, 0.18), inset 0 1px 0 rgba(255,255,255,0.12);
  }

  .badge-expired {
    background: rgba(239, 68, 68, 0.13);
    border: 1px solid rgba(239, 68, 68, 0.35);
    color: #ef4444;
    box-shadow: 0 0 12px rgba(239, 68, 68, 0.18), inset 0 1px 0 rgba(255,255,255,0.12);
    animation: pulse-glow-red 2.5s ease-in-out infinite;
  }

  .badge-invalid {
    background: rgba(100, 116, 139, 0.1);
    border: 1px solid rgba(100, 116, 139, 0.25);
    color: hsl(var(--muted-foreground));
  }

  /* ── Avatar Glow Ring ── */
  .avatar-glow {
    box-shadow:
      0 0 0 2px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.5),
      0 0 16px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.22);
  }

  /* ── Stat Card Variants ── */
  .stat-card {
    @apply glass-card;
    animation: scale-in 0.4s cubic-bezier(0.4, 0, 0.2, 1) both;
  }

  .stat-card-purple { --card-r: 168; --card-g: 85;  --card-b: 247; }
  .stat-card-amber  { --card-r: 234; --card-g: 179; --card-b: 8;   }
  .stat-card-red    { --card-r: 239; --card-g: 68;  --card-b: 68;  }
  .stat-card-cyan   { --card-r: 6;   --card-g: 214; --card-b: 245; }

  .stat-card:hover {
    box-shadow:
      0 0 0 1px rgba(var(--card-r, var(--glow-primary-r)), var(--card-g, var(--glow-primary-g)), var(--card-b, var(--glow-primary-b)), 0.3),
      0 20px 60px -8px rgba(var(--card-r, var(--glow-primary-r)), var(--card-g, var(--glow-primary-g)), var(--card-b, var(--glow-primary-b)), 0.2),
      0 8px 24px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  .stat-icon {
    background: rgba(var(--card-r, var(--glow-primary-r)), var(--card-g, var(--glow-primary-g)), var(--card-b, var(--glow-primary-b)), 0.14);
    border-radius: 12px;
    padding: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
      0 0 20px rgba(var(--card-r, var(--glow-primary-r)), var(--card-g, var(--glow-primary-g)), var(--card-b, var(--glow-primary-b)), 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    color: rgb(var(--card-r, var(--glow-primary-r)), var(--card-g, var(--glow-primary-g)), var(--card-b, var(--glow-primary-b)));
  }

  /* ── Medicine Icon Circle ── */
  .medicine-icon-circle {
    background: linear-gradient(135deg,
      rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.15),
      rgba(var(--glow-accent-r), var(--glow-accent-g), var(--glow-accent-b), 0.1)
    );
    border: 1px solid rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.2);
    box-shadow: 0 0 16px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.12);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  /* ── Ghost Input ── */
  .glass-input {
    background: rgba(var(--glass-r), var(--glass-g), var(--glass-b), calc(var(--glass-opacity) * 0.8));
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, calc(var(--glass-border-opacity) * 0.7));
    transition: all 0.25s ease;
  }

  .glass-input:focus {
    background: rgba(var(--glass-r), var(--glass-g), var(--glass-b), calc(var(--glass-opacity) * 1.1));
    border-color: rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.5);
    box-shadow: 0 0 0 3px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.15);
    outline: none;
  }

  /* ── Floating Orb Background Decorations ── */
  .bg-orb {
    position: fixed;
    border-radius: 50%;
    filter: blur(80px);
    pointer-events: none;
    z-index: 0;
  }

  /* ── Scrollbar ── */
  ::-webkit-scrollbar { width: 5px; height: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb {
    background: rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.28);
    border-radius: 3px;
    transition: background 0.2s;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.48);
  }
}

/* ───────────────────────────────────────────────
   KEYFRAME ANIMATIONS
─────────────────────────────────────────────── */

@keyframes float {
  0%, 100% { transform: translateY(0px) scale(1); }
  40%       { transform: translateY(-18px) scale(1.03); }
  70%       { transform: translateY(-10px) scale(0.97); }
}

@keyframes float-delayed {
  0%, 100% { transform: translateY(0px) scale(1); }
  35%       { transform: translateY(-24px) scale(1.04); }
  65%       { transform: translateY(-12px) scale(0.96); }
}

@keyframes float-slow {
  0%, 100% { transform: translateY(0px) translateX(0px); }
  33%       { transform: translateY(-14px) translateX(6px); }
  66%       { transform: translateY(-7px) translateX(-4px); }
}

@keyframes pulse-glow {
  0%, 100% {
    box-shadow:
      0 0 0 1px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.4),
      0 0 16px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.2);
  }
  50% {
    box-shadow:
      0 0 0 1px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.6),
      0 0 28px rgba(var(--glow-primary-r), var(--glow-primary-g), var(--glow-primary-b), 0.38);
  }
}

@keyframes pulse-glow-red {
  0%, 100% { box-shadow: 0 0 8px rgba(239, 68, 68, 0.18); }
  50%       { box-shadow: 0 0 18px rgba(239, 68, 68, 0.38); }
}

@keyframes gradient-shift {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes slide-up {
  from { opacity: 0; transform: translateY(14px); }
  to   { opacity: 1; transform: translateY(0); }
}

@keyframes fade-in {
  from { opacity: 0; }
  to   { opacity: 1; }
}

@keyframes scale-in {
  from { opacity: 0; transform: scale(0.95); }
  to   { opacity: 1; transform: scale(1); }
}

@keyframes shimmer-sweep {
  0%   { left: -120%; }
  100% { left: 160%; }
}

@keyframes border-flow {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}
